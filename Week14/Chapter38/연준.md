[CH38] 브라우저의 렌더링 과정

브라우저의 렌더링 과정은 웹 페이지를 사용자에게 시각적으로 보여주는 과정을 의미하며, 여러 단계로 이루어져 있다. 이 과정을 자세히 설명하면 다음과 같다.

1. HTML 파싱과 DOM 생성
   HTML 문서 다운로드
   사용자가 URL을 입력하거나 링크를 클릭하면 브라우저는 해당 웹 페이지의 HTML 문서를 서버에서 다운로드한다.
   HTML 파싱
   브라우저는 HTML 파일을 읽고 파싱한다. HTML 파서는 HTML 태그를 하나씩 읽으면서 DOM(Document Object Model) 트리를 생성한다.
   DOM 트리는 HTML 문서의 구조를 트리 형태로 표현한 것으로, 각 HTML 요소가 노드로 표현된다.
2. CSS 파싱과 CSSOM 생성
   CSS 다운로드
   HTML 문서 안에 <link> 태그로 연결된 CSS 파일들을 다운로드한다.
   CSS 파싱
   CSS 파일을 파싱하여 CSSOM(CSS Object Model) 트리를 생성한다.
   CSSOM 트리는 CSS 규칙들을 트리 형태로 표현한 것이다.
3. 렌더 트리 생성
   DOM과 CSSOM 결합
   브라우저는 DOM 트리와 CSSOM 트리를 결합하여 렌더 트리(Render Tree)를 생성한다.
   렌더 트리는 화면에 표시되어야 할 모든 노드와 스타일 정보를 포함하며, 실제로 화면에 그려질 요소들로만 구성된다. 예를 들어, display: none으로 설정된 요소는 렌더 트리에 포함되지 않는다.
4. 레이아웃 (Layout)
   레이아웃 계산
   렌더 트리의 각 요소의 크기와 위치를 계산한다. 이 과정은 "reflow" 또는 "layout"이라고 불리며, 부모 요소부터 자식 요소로 내려가며 각 요소의 위치와 크기를 결정한다.
   이 과정에서 브라우저는 뷰포트(viewport)의 크기, 각 요소의 스타일 규칙 등을 고려한다.
5. 페인팅 (Painting)
   페인팅
   레이아웃 단계에서 계산된 정보를 바탕으로 실제 픽셀을 화면에 그린다. 이 과정은 "paint" 또는 "rasterize"라고 불린다.
   페인팅 단계는 렌더 트리의 각 요소를 다양한 레이어로 나누어 처리한다. 각 레이어는 여러 페인트 서버를 통해 개별적으로 그려지고, 이후 하나의 이미지로 합쳐진다.
6. 합성 (Compositing)
   합성
   모든 레이어가 개별적으로 페인팅된 후, 합성 단계에서 이 레이어들을 하나의 이미지로 합친다.
   합성은 GPU를 사용하여 빠르게 처리되며, 최종 이미지를 화면에 표시한다.
   세부사항 및 최적화
   자바스크립트 실행
   HTML 파싱 도중 `<script>` 태그를 만나면 브라우저는 자바스크립트 파일을 다운로드하고 실행한다. 자바스크립트는 DOM이나 CSSOM을 변경할 수 있으므로, 변경이 발생하면 해당 부분의 렌더링 과정을 다시 실행한다.

비동기 스크립트(async나 defer 속성을 가진 스크립트)는 파싱을 멈추지 않고 백그라운드에서 다운로드 및 실행된다.
스타일 계산
CSSOM이 변경되거나 자바스크립트에 의해 스타일이 변경되면 브라우저는 스타일을 다시 계산한다.

레이아웃 트리 최적화
레이아웃 변경이 일어나면 브라우저는 필요한 부분만 다시 레이아웃을 계산하려고 노력한다. 예를 들어, 특정 요소의 위치나 크기만 변경되었을 때 전체 레이아웃을 다시 계산하지 않도록 최적화한다.

페인팅 최적화
일부 요소만 변경된 경우, 브라우저는 해당 요소와 관련된 부분만 다시 페인팅하여 전체 성능을 최적화한다.

합성 최적화
레이아웃이나 페인팅 단계의 최적화와 마찬가지로, 합성 단계에서도 변경된 레이어만 다시 합성한다. 이를 통해 불필요한 작업을 최소화하여 렌더링 성능을 향상시킨다.

이와 같이 브라우저의 렌더링 과정은 여러 단계로 구성되어 있으며, 각 단계는 웹 페이지를 빠르고 효율적으로 그리기 위해 복잡한 최적화 과정을 포함하고 있다.
