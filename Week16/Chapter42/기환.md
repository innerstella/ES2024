# 42장 비동기 프로그래밍

## 42.1 동기 처리와 비동기 처리
자바스크립트에서 함수가 호출되면 다음과 같은 과정을 거침
- 함수 호출 -> 함수 코드 평가 -> 함수 실행 컨텍스트 생성 -> 실행 컨텍스트 스택 푸시 -> 함수 실행 -> 함수 실행 종료 -> 실행 컨텍스트 스탭 팝
- 즉, 함수가 실행되려면 함수 실행 컨텍스트가 실행 컨텍스트 스택에 푸시되어야함
  - 함수의 실행 순서는 실행 컨텍스트 스택으로 관리

- 자바스크립트 엔진은 단 하나의 실행 컨텍스트 스택을 가짐
  - 동시에 2개 이상의 함수를 실행할 수 없음
  - 싱글 스레드 방식으로 동작
    - 하나의 태스크만 실행할 수 있음
    - 처리에 시간이 걸리는 태스크를 실행하면 블로킹(작업중단)이 발생

- **동기 처리**
  - 현재 실행 중인 태스크가 종료할 때까지 다음에 실행될 태스크가 대기하는 방식
  - 순서대로 하나씩 처리하므로 실행 순서가 보장된다는 장점이 있음
  - 앞선 태스크가 종료할 때까지 이후 태스크들이 블로킹 되는 단점이 있음
- **비동기 처리**
  - 현재 실행 중인 태스크가 종료되지 않은 상태라 해도 다음 태스크를 곧바로 실행하는 방식
  - 현재 실행 중인 태스크가 종료되지 않은 상태라 해도 다음 태스크를 곧바로 실행하므로 블로킹이 발생하지 않는다는 장점이 있음
  - 태스크의 실행 순서가 보장되지 않는다는 단점이 있음

## 42.2 이벤트 루프와 태스크 큐
- 자바스크립트의 동시성을 지원하는 것이 이벤트 루프다.
- 자바스크립트 엔진의 영역
  - **콜 스택**
    - 실행 컨텍스트 스택(순서 관리)
  - **힙**
    - 객체가 저장되는 메모리 공간
    - 실행 컨텍스트가 힙에 저장된 객체를 참조
    - 할당해야 할 메모리 공간의 크기를 런타임에 결정(동적할당)하므로 구조화 되어 있지 않음
- 자바스크립트 엔진은 단순히 태크스가 요청되면 순차적으로 실행만함
  - 비동기 처리에서 평가와 실행을 제외한 모든 처리는 부라우저 or Node.js가 담당
  - **태스크 큐**
    - 비동기 함수의 콜백 함수 or 이벤트 핸들러가 일시적으로 보관되는 영역
    - 비슷한 영역인 마이크로 태스크 큐가 존재(45장)
  - **이벤트 루프**
    - 콜 스택에 실행 중인 실행 컨텍스트가 있는지, 태스크 큐에 대기 중인 함수가 있는지 반복해서 확인
    -콜 스택이 비어 있고 태스크 큐에 대기 중인 함수가 있다면 순차적으로 태스크 큐에 대기 중인 함수를 콜 스택으로 이동시킴
-즉, **자바스크립트는 싱글 스레드 방식**, **브라우저는 멀티 스레드 방식**으로 동작
